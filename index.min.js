"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function bufferSplit(e,n){cov_1fj4aexxlh.f[0]++,cov_1fj4aexxlh.s[0]++,(0,_assert2.default)(e.length%n==0);var l=(cov_1fj4aexxlh.s[1]++,e.length/n);return cov_1fj4aexxlh.s[2]++,range(n).map(function(n){return cov_1fj4aexxlh.f[1]++,cov_1fj4aexxlh.s[3]++,e.slice(l*n,l*(n+1))})}function flatten(e){return cov_1fj4aexxlh.f[2]++,cov_1fj4aexxlh.s[4]++,e.reduce(function(e,n){var l=n.X,o=n.y;return cov_1fj4aexxlh.f[3]++,cov_1fj4aexxlh.s[5]++,e.X=e.X.concat(l),cov_1fj4aexxlh.s[6]++,e.y=e.y.concat(o),cov_1fj4aexxlh.s[7]++,e},{X:[],y:[]})}function range(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(cov_1fj4aexxlh.b[0][0]++,e);cov_1fj4aexxlh.f[4]++,cov_1fj4aexxlh.s[8]++,e===n?(cov_1fj4aexxlh.b[1][0]++,cov_1fj4aexxlh.s[9]++,e=0):cov_1fj4aexxlh.b[1][1]++;var l=(cov_1fj4aexxlh.s[10]++,[]);cov_1fj4aexxlh.s[11]++;for(var o=e;o<n;o++)cov_1fj4aexxlh.s[12]++,l.push(o);return cov_1fj4aexxlh.s[13]++,l}function isStream(e){return cov_1fj4aexxlh.f[5]++,cov_1fj4aexxlh.s[14]++,cov_1fj4aexxlh.b[2][0]++,null!==e&&(cov_1fj4aexxlh.b[2][1]++,"object"===(void 0===e?"undefined":(0,_typeof3.default)(e)))&&(cov_1fj4aexxlh.b[2][2]++,"function"==typeof e.pipe)}function createStream(e,n){var l=n.totalSize;cov_1fj4aexxlh.f[10]++;var o=(cov_1fj4aexxlh.s[25]++,_fs2.default.createReadStream(e,{highWaterMark:l}));return cov_1fj4aexxlh.s[26]++,o.on("error",function(e){throw cov_1fj4aexxlh.f[11]++,cov_1fj4aexxlh.s[27]++,"ENOENT"===e.code?(cov_1fj4aexxlh.b[3][0]++,cov_1fj4aexxlh.s[28]++,console.error("Data files are not existed. Run '"+__dirname+"/get_datasets.sh'")):cov_1fj4aexxlh.b[3][1]++,cov_1fj4aexxlh.s[29]++,e}),cov_1fj4aexxlh.s[30]++,o}function createPromise(e,n){cov_1fj4aexxlh.f[12]++;var l=(cov_1fj4aexxlh.s[31]++,[]);return cov_1fj4aexxlh.s[32]++,isStream(e)?(cov_1fj4aexxlh.b[4][1]++,cov_1fj4aexxlh.s[34]++,new _promise2.default(function(o,t){function c(e){cov_1fj4aexxlh.f[14]++,cov_1fj4aexxlh.s[35]++,l.push(n.mapper(e))}function a(){cov_1fj4aexxlh.f[15]++;var e=(cov_1fj4aexxlh.s[36]++,l.reduce(function(e,n){var l=n.X,o=n.y;return cov_1fj4aexxlh.f[16]++,cov_1fj4aexxlh.s[37]++,e.X.push(l),cov_1fj4aexxlh.s[38]++,e.y.push(o),cov_1fj4aexxlh.s[39]++,e},{X:[],y:[]}));cov_1fj4aexxlh.s[40]++,o(e),cov_1fj4aexxlh.s[41]++,l=null,cov_1fj4aexxlh.s[42]++,i()}function i(){cov_1fj4aexxlh.f[17]++,cov_1fj4aexxlh.s[43]++,e.removeListener("data",c),cov_1fj4aexxlh.s[44]++,e.removeListener("end",a),cov_1fj4aexxlh.s[45]++,e.removeListener("close",a)}cov_1fj4aexxlh.f[13]++,cov_1fj4aexxlh.s[46]++;try{cov_1fj4aexxlh.s[47]++,e.on("data",c),cov_1fj4aexxlh.s[48]++,e.on("end",a),cov_1fj4aexxlh.s[49]++,e.on("close",a)}catch(e){i(),t(e)}})):(cov_1fj4aexxlh.b[4][0]++,cov_1fj4aexxlh.s[33]++,_promise2.default.resolve(n.mapper(e)))}var cov_1fj4aexxlh=function(){var e="/Users/kp/workspace/playground/cifar-10-js/src/index.js",n="3667ae88c709b76ef63e16a8a07dfa07f2078ec0",l=new Function("return this")(),o="__coverage__",t={path:"/Users/kp/workspace/playground/cifar-10-js/src/index.js",statementMap:{0:{start:{line:7,column:2},end:{line:7,column:38}},1:{start:{line:8,column:19},end:{line:8,column:40}},2:{start:{line:9,column:2},end:{line:9,column:77}},3:{start:{line:9,column:33},end:{line:9,column:75}},4:{start:{line:13,column:2},end:{line:20,column:5}},5:{start:{line:14,column:4},end:{line:14,column:28}},6:{start:{line:15,column:4},end:{line:15,column:28}},7:{start:{line:16,column:4},end:{line:16,column:15}},8:{start:{line:24,column:2},end:{line:24,column:31}},9:{start:{line:24,column:21},end:{line:24,column:31}},10:{start:{line:25,column:17},end:{line:25,column:19}},11:{start:{line:27,column:2},end:{line:28,column:19}},12:{start:{line:28,column:4},end:{line:28,column:19}},13:{start:{line:30,column:2},end:{line:30,column:16}},14:{start:{line:34,column:2},end:{line:36,column:38}},15:{start:{line:40,column:23},end:{line:64,column:1}},16:{start:{line:43,column:4},end:{line:43,column:51}},17:{start:{line:46,column:4},end:{line:46,column:52}},18:{start:{line:46,column:31},end:{line:46,column:50}},19:{start:{line:49,column:4},end:{line:49,column:42}},20:{start:{line:56,column:4},end:{line:56,column:65}},21:{start:{line:59,column:14},end:{line:59,column:22}},22:{start:{line:60,column:14},end:{line:61,column:46}},23:{start:{line:61,column:26},end:{line:61,column:45}},24:{start:{line:62,column:4},end:{line:62,column:20}},25:{start:{line:69,column:17},end:{line:69,column:73}},26:{start:{line:71,column:2},end:{line:75,column:5}},27:{start:{line:72,column:4},end:{line:73,column:85}},28:{start:{line:73,column:6},end:{line:73,column:85}},29:{start:{line:74,column:6},end:{line:74,column:16}},30:{start:{line:77,column:2},end:{line:77,column:16}},31:{start:{line:81,column:15},end:{line:81,column:17}},32:{start:{line:82,column:2},end:{line:84,column:3}},33:{start:{line:83,column:4},end:{line:83,column:50}},34:{start:{line:86,column:2},end:{line:120,column:5}},35:{start:{line:88,column:6},end:{line:88,column:39}},36:{start:{line:92,column:18},end:{line:99,column:8}},37:{start:{line:93,column:8},end:{line:93,column:22}},38:{start:{line:94,column:8},end:{line:94,column:22}},39:{start:{line:95,column:8},end:{line:95,column:19}},40:{start:{line:100,column:6},end:{line:100,column:19}},41:{start:{line:101,column:6},end:{line:101,column:20}},42:{start:{line:102,column:6},end:{line:102,column:24}},43:{start:{line:106,column:6},end:{line:106,column:46}},44:{start:{line:107,column:6},end:{line:107,column:44}},45:{start:{line:108,column:6},end:{line:108,column:46}},46:{start:{line:111,column:4},end:{line:119,column:5}},47:{start:{line:112,column:6},end:{line:112,column:35}},48:{start:{line:113,column:6},end:{line:113,column:33}},49:{start:{line:114,column:6},end:{line:114,column:35}},50:{start:{line:124,column:13},end:{line:125,column:56}},51:{start:{line:124,column:31},end:{line:124,column:58}},52:{start:{line:125,column:29},end:{line:125,column:55}},53:{start:{line:126,column:2},end:{line:126,column:63}},54:{start:{line:126,column:46},end:{line:126,column:61}},55:{start:{line:130,column:2},end:{line:145,column:3}},56:{start:{line:131,column:39},end:{line:131,column:81}},57:{start:{line:132,column:37},end:{line:132,column:78}},58:{start:{line:134,column:4},end:{line:139,column:5}},59:{start:{line:142,column:4},end:{line:143,column:81}},60:{start:{line:143,column:4},end:{line:143,column:81}},61:{start:{line:144,column:4},end:{line:144,column:14}}},fnMap:{0:{name:"bufferSplit",decl:{start:{line:6,column:16},end:{line:6,column:27}},loc:{start:{line:6,column:42},end:{line:10,column:1}},line:6},1:{name:"(anonymous_1)",decl:{start:{line:9,column:28},end:{line:9,column:29}},loc:{start:{line:9,column:33},end:{line:9,column:75}},line:9},2:{name:"flatten",decl:{start:{line:12,column:9},end:{line:12,column:16}},loc:{start:{line:12,column:22},end:{line:21,column:1}},line:12},3:{name:"(anonymous_3)",decl:{start:{line:13,column:20},end:{line:13,column:21}},loc:{start:{line:13,column:37},end:{line:17,column:3}},line:13},4:{name:"range",decl:{start:{line:23,column:9},end:{line:23,column:14}},loc:{start:{line:23,column:33},end:{line:31,column:1}},line:23},5:{name:"isStream",decl:{start:{line:33,column:16},end:{line:33,column:24}},loc:{start:{line:33,column:33},end:{line:37,column:1}},line:33},6:{name:"(anonymous_6)",decl:{start:{line:42,column:16},end:{line:42,column:17}},loc:{start:{line:42,column:34},end:{line:44,column:3}},line:42},7:{name:"(anonymous_7)",decl:{start:{line:46,column:26},end:{line:46,column:27}},loc:{start:{line:46,column:31},end:{line:46,column:50}},line:46},8:{name:"(anonymous_8)",decl:{start:{line:58,column:10},end:{line:58,column:11}},loc:{start:{line:58,column:27},end:{line:63,column:3}},line:58},9:{name:"(anonymous_9)",decl:{start:{line:61,column:19},end:{line:61,column:20}},loc:{start:{line:61,column:26},end:{line:61,column:45}},line:61},10:{name:"createStream",decl:{start:{line:68,column:16},end:{line:68,column:28}},loc:{start:{line:68,column:51},end:{line:78,column:1}},line:68},11:{name:"(anonymous_11)",decl:{start:{line:71,column:21},end:{line:71,column:22}},loc:{start:{line:71,column:30},end:{line:75,column:3}},line:71},12:{name:"createPromise",decl:{start:{line:80,column:16},end:{line:80,column:29}},loc:{start:{line:80,column:46},end:{line:121,column:1}},line:80},13:{name:"(anonymous_13)",decl:{start:{line:86,column:21},end:{line:86,column:22}},loc:{start:{line:86,column:42},end:{line:120,column:3}},line:86},14:{name:"converter",decl:{start:{line:87,column:13},end:{line:87,column:22}},loc:{start:{line:87,column:29},end:{line:89,column:5}},line:87},15:{name:"resolver",decl:{start:{line:91,column:13},end:{line:91,column:21}},loc:{start:{line:91,column:24},end:{line:103,column:5}},line:91},16:{name:"(anonymous_16)",decl:{start:{line:92,column:32},end:{line:92,column:33}},loc:{start:{line:92,column:49},end:{line:96,column:7}},line:92},17:{name:"removeListeners",decl:{start:{line:105,column:13},end:{line:105,column:28}},loc:{start:{line:105,column:31},end:{line:109,column:5}},line:105},18:{name:"combine",decl:{start:{line:123,column:22},end:{line:123,column:29}},loc:{start:{line:123,column:46},end:{line:127,column:1}},line:123},19:{name:"(anonymous_19)",decl:{start:{line:124,column:23},end:{line:124,column:24}},loc:{start:{line:124,column:31},end:{line:124,column:58}},line:124},20:{name:"(anonymous_20)",decl:{start:{line:125,column:23},end:{line:125,column:24}},loc:{start:{line:125,column:29},end:{line:125,column:55}},line:125},21:{name:"(anonymous_21)",decl:{start:{line:126,column:36},end:{line:126,column:37}},loc:{start:{line:126,column:46},end:{line:126,column:61}},line:126},22:{name:"load",decl:{start:{line:129,column:22},end:{line:129,column:26}},loc:{start:{line:129,column:44},end:{line:146,column:1}},line:129}},branchMap:{0:{loc:{start:{line:23,column:22},end:{line:23,column:31}},type:"default-arg",locations:[{start:{line:23,column:26},end:{line:23,column:31}}],line:23},1:{loc:{start:{line:24,column:2},end:{line:24,column:31}},type:"if",locations:[{start:{line:24,column:2},end:{line:24,column:31}},{start:{line:24,column:2},end:{line:24,column:31}}],line:24},2:{loc:{start:{line:34,column:9},end:{line:36,column:37}},type:"binary-expr",locations:[{start:{line:34,column:9},end:{line:34,column:24}},{start:{line:35,column:4},end:{line:35,column:30}},{start:{line:36,column:4},end:{line:36,column:37}}],line:34},3:{loc:{start:{line:72,column:4},end:{line:73,column:85}},type:"if",locations:[{start:{line:72,column:4},end:{line:73,column:85}},{start:{line:72,column:4},end:{line:73,column:85}}],line:72},4:{loc:{start:{line:82,column:2},end:{line:84,column:3}},type:"if",locations:[{start:{line:82,column:2},end:{line:84,column:3}},{start:{line:82,column:2},end:{line:84,column:3}}],line:82},5:{loc:{start:{line:129,column:27},end:{line:129,column:42}},type:"default-arg",locations:[{start:{line:129,column:35},end:{line:129,column:42}}],line:129},6:{loc:{start:{line:142,column:4},end:{line:143,column:81}},type:"if",locations:[{start:{line:142,column:4},end:{line:143,column:81}},{start:{line:142,column:4},end:{line:143,column:81}}],line:142}},s:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0,25:0,26:0,27:0,28:0,29:0,30:0,31:0,32:0,33:0,34:0,35:0,36:0,37:0,38:0,39:0,40:0,41:0,42:0,43:0,44:0,45:0,46:0,47:0,48:0,49:0,50:0,51:0,52:0,53:0,54:0,55:0,56:0,57:0,58:0,59:0,60:0,61:0},f:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0},b:{0:[0],1:[0,0],2:[0,0,0],3:[0,0],4:[0,0],5:[0],6:[0,0]},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},c=l[o]||(l[o]={});return c[e]&&c[e].hash===n?c[e]:(t.hash=n,c[e]=t)}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.load=exports.combine=exports.cifar10=void 0;var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=require("babel-runtime/helpers/asyncToGenerator"),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_typeof2=require("babel-runtime/helpers/typeof"),_typeof3=_interopRequireDefault(_typeof2),combine=exports.combine=function(){var e=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(n,l){var o;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return cov_1fj4aexxlh.f[18]++,cov_1fj4aexxlh.s[50]++,o=n.map(function(e){return cov_1fj4aexxlh.f[19]++,cov_1fj4aexxlh.s[51]++,createStream(e,l)}).map(function(e){return cov_1fj4aexxlh.f[20]++,cov_1fj4aexxlh.s[52]++,createPromise(e,l)}),cov_1fj4aexxlh.s[53]++,e.next=5,_promise2.default.all(o).then(function(e){return cov_1fj4aexxlh.f[21]++,cov_1fj4aexxlh.s[54]++,flatten(e)});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(n,l){return e.apply(this,arguments)}}(),load=exports.load=function(){var e=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(){var n,l,o,t,c,a,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(cov_1fj4aexxlh.b[5][0]++,cifar10);return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return cov_1fj4aexxlh.f[22]++,cov_1fj4aexxlh.s[55]++,e.prev=2,cov_1fj4aexxlh.s[56]++,e.next=6,combine(i.trainFiles,i);case 6:return n=e.sent,l=n.X,o=n.y,cov_1fj4aexxlh.s[57]++,e.next=12,combine(i.testFiles,i);case 12:return t=e.sent,c=t.X,a=t.y,cov_1fj4aexxlh.s[58]++,e.abrupt("return",{X_train:l,y_train:o,X_test:c,y_test:a});case 19:throw e.prev=19,e.t0=e.catch(2),cov_1fj4aexxlh.s[59]++,"ENOENT"===e.t0.code?(cov_1fj4aexxlh.b[6][0]++,cov_1fj4aexxlh.s[60]++,console.log("Data files are not existed. Run '"+__dirname+"/get_datasets.sh'")):cov_1fj4aexxlh.b[6][1]++,cov_1fj4aexxlh.s[61]++,e.t0;case 25:case"end":return e.stop()}},e,this,[[2,19]])}));return function(){return e.apply(this,arguments)}}();exports.bufferSplit=bufferSplit,exports.isStream=isStream,exports.createStream=createStream,exports.createPromise=createPromise;var _fs=require("fs"),_fs2=_interopRequireDefault(_fs),_path=require("path"),_path2=_interopRequireDefault(_path),_assert=require("assert"),_assert2=_interopRequireDefault(_assert),cifar10=exports.cifar10=(cov_1fj4aexxlh.s[15]++,{dir:_path2.default.join(__dirname,"cifar-10-batches-bin"),getFileName:function(e){return cov_1fj4aexxlh.f[6]++,cov_1fj4aexxlh.s[16]++,this.dir+"/data_batch_"+e+".bin"},get trainFiles(){var e=this;return cov_1fj4aexxlh.s[17]++,range(1,6).map(function(n){return cov_1fj4aexxlh.f[7]++,cov_1fj4aexxlh.s[18]++,e.getFileName(n)})},get testFiles(){return cov_1fj4aexxlh.s[19]++,[this.dir+"/test_batch.bin"]},cols:32,rows:32,channel:3,valueSize:1,get totalSize(){return cov_1fj4aexxlh.s[20]++,this.valueSize+this.channel*this.cols*this.rows},mapper:function(e){cov_1fj4aexxlh.f[8]++;var n=(cov_1fj4aexxlh.s[21]++,e[0]),l=(cov_1fj4aexxlh.s[22]++,bufferSplit(e.slice(this.valueSize),this.channel).map(function(e){return cov_1fj4aexxlh.f[9]++,cov_1fj4aexxlh.s[23]++,new Uint8Array(e)}));return cov_1fj4aexxlh.s[24]++,{X:l,y:n}}});exports.default={createStream:createStream,createPromise:createPromise,combine:combine,load:load};
//# sourceMappingURL=sourceMap.map